---
layout:     post
title:      æ— äººæœºæŸœ
subtitle:   å¤§ç–†
date:       2025-08-13
author:     LXG
header-img: img/post-bg-DJI.jpg
catalog: true
tags:
    - ç¡¬ä»¶
---

[èˆªæ‹ä¹‹æ—…-å…±äº«æ— äººæœºæŸœ](https://www.hangpaizhilv.com/)

## ç¡¬ä»¶éƒ¨åˆ†

| æ¨¡å—         | åŠŸèƒ½           | å…¸å‹éƒ¨ä»¶/å»ºè®®                                     |
| ---------- | ------------ | ------------------------------------------- |
| **æœºæŸœç»“æ„**   | æ”¯æ’‘å’Œä¿æŠ¤æ— äººæœº     | é‡‘å±æœºæŸœæˆ–é«˜å¼ºåº¦å¡‘æ–™ï¼Œå¸¦é˜²é›¨é˜²å°˜è®¾è®¡                          |
| **å­˜æ”¾ä»“ä½**   | æ— äººæœºå­˜æ”¾ã€é”å®š     | å¯æ§ç”µå­é”æˆ–ç”µç£é”ï¼›ä»“ä½æ‰˜ç›˜è®¾è®¡ï¼Œé€‚é…ä¸åŒå‹å·æ— äººæœº                  |
| **å……ç”µç³»ç»Ÿ**   | å¯¹æ— äººæœºç”µæ± å……ç”µ     | å……ç”µæ¨¡å—ï¼ˆæ™ºèƒ½é”‚ç”µæ± å……ç”µå™¨ï¼‰ï¼Œç”µæºç®¡ç†æ¿                        |
| **æ§åˆ¶æ¿/ä¸»æ§** | ç®¡ç†æŸœå­å„æ¨¡å—      | MCU æˆ–åµŒå…¥å¼Linuxä¸»æ§ï¼ˆå¦‚Raspberry Pi, STM32, RKèŠ¯ç‰‡ï¼‰ |
| **é€šä¿¡æ¨¡å—**   | ä¸æœåŠ¡å™¨å’Œç”¨æˆ·APPäº¤äº’ | 4G/5Gæ¨¡å—ã€Wi-Fiã€è“ç‰™ï¼Œæˆ–NB-IoT                    |
| **ä¼ æ„Ÿå™¨**    | å®‰å…¨å’ŒçŠ¶æ€ç›‘æ§      | é—¨ç£ä¼ æ„Ÿå™¨ã€çº¢å¤–/å…‰ç”µæ£€æµ‹ã€é‡é‡ä¼ æ„Ÿå™¨ï¼ˆåˆ¤æ–­æ— äººæœºæ˜¯å¦åœ¨ä½ï¼‰              |
| **æ˜¾ç¤ºä¸äº¤äº’**  | ç”¨æˆ·æ“ä½œç•Œé¢       | LCD/è§¦æ‘¸å±ã€LEDæŒ‡ç¤ºç¯ã€æŒ‰é’®æˆ–æ‰«ç å™¨                       |
| **å®‰å…¨é˜²æŠ¤**   | é˜²ç›—ã€é˜²ç«        | é˜²æ’¬ä¼ æ„Ÿå™¨ã€é˜²ç«ææ–™ã€æŠ¥è­¦å™¨                              |
| **ç”µæº**     | ç³»ç»Ÿä¾›ç”µ         | äº¤æµç”µè¾“å…¥ã€UPS/å¤‡ç”¨ç”µæ± ï¼Œå¿…è¦æ—¶æ”¯æŒå¤ªé˜³èƒ½æ¿                    |
| **ç¯å¢ƒç›‘æ§**   | æ¸©æ¹¿åº¦æ§åˆ¶        | æ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨ã€é£æ‰‡æˆ–å°å‹ç©ºè°ƒ                              |

## æ–­è·¯å™¨

![power_switch](/images/hardware/cabinet/power_switch.jpg)

| ç‰¹æ€§ / å±æ€§  | CHINT NXB-63 C20          | CHINT NXU-II G 40/275          |
| -------- | ------------------------- | ------------------------------ |
| **æ ¸å¿ƒåŠŸèƒ½** | è¿‡è½½ä¸çŸ­è·¯ä¿æŠ¤ã€æ–­ç”µéš”ç¦»              | é˜²é›·å‡»å’Œç¬æ€è¿‡ç”µå‹ä¿æŠ¤                    |
| **å…¸å‹ç”¨é€”** | é…ç”µç³»ç»ŸåŠç”µæ°”è®¾å¤‡ç”µæµä¿æŠ¤             | ç”µæ¶Œä¿æŠ¤ï¼Œä¿æŠ¤ç³»ç»Ÿè®¾å¤‡å…å—è¿‡ç”µå‹æŸå®³             |
| **é¢å®šå‚æ•°** | 20A ç”µæµã€çº¦ 400V é¢å®šç”µå‹        | 40 kA å†²å‡»ç”µæµã€275 V æŒç»­ç”µå‹          |
| **ç¬¦åˆæ ‡å‡†** | GB/T 10963.1, IEC 60898-1 | IEC/EN 61643-11, GB/T 18802.11 |
| **ä¿æŠ¤æœºåˆ¶** | æ–­ç”µåˆ‡æ–­ä¿æŠ¤                    | å¸æ”¶æˆ–æ—è·¯ç”µæ¶Œï¼Œä¿æŠ¤è®¾å¤‡                   |
| **ç»“æ„ç‰¹ç‚¹** | ä¼ ç»Ÿæ–­è·¯å™¨ç»“æ„                   | æ¨¡å—åŒ–è®¾è®¡ï¼Œå¯åœ¨çº¿æ›´æ¢æ¨¡å—                  |

**ä½¿ç”¨å»ºè®®**

1. è‹¥ä½ çš„éœ€æ±‚æ˜¯é’ˆå¯¹ç”µè·¯ä¸­çš„è¿‡è½½æˆ–çŸ­è·¯äº‹ä»¶è¿›è¡Œä¿æŠ¤â€”â€”æ¯”å¦‚å½“ç”µæµè¿‡å¤§æˆ–å‘ç”ŸçŸ­è·¯æ—¶å¸Œæœ›è‡ªåŠ¨æ–­å¼€ç”µè·¯â€”â€”åˆ™åº”é€‰æ‹© NXB-63 C20 å°å‹æ–­è·¯å™¨ã€‚
2. è‹¥ä½ éœ€è¦é˜²æŠ¤æ¥è‡ªç”µç½‘çš„ç¬æ€é«˜å‹å†²å‡»ï¼ˆå¦‚é›·å‡»æˆ–ç”µå‹æµªæ¶Œï¼‰â€”â€”ä¿æŠ¤åçº§è®¾å¤‡ä¸è¢«é«˜ç”µå‹æŸåâ€”â€”åˆ™åº”é€‰æ‹© NXU-II G 40/275 ç”µæ¶Œä¿æŠ¤å™¨ã€‚
3. å®é™…åº”ç”¨ä¸­ï¼Œè¿™ä¸¤ç§äº§å“å¸¸å¸¸å¯ä»¥é…å¥—ä½¿ç”¨ï¼šæ–­è·¯å™¨è´Ÿè´£å¸¸è§„ä¿æŠ¤ï¼Œç”µæ¶Œä¿æŠ¤å™¨è´Ÿè´£çªå‘é«˜å‹å†²å‡»ä¿æŠ¤ï¼Œå½¢æˆå‰åååŒæœºåˆ¶ï¼Œæé«˜æ•´ä½“ç”µæ°”å®‰å…¨æ€§ã€‚

**å•ç›¸ç”µå­å¼å¯¼è½¨æ™ºèƒ½ç”µèƒ½è¡¨**

ç”¨äºæµ‹é‡å’Œè®°å½•ç”µåŠ›æ¶ˆè€—ã€‚è¯¥ç”µèƒ½è¡¨ç¬¦åˆå›½å®¶æ ‡å‡†GB/T 17215.321-2008ï¼Œå¹¶ä¸”å¸¦æœ‰äºŒç»´ç ï¼Œå¯èƒ½ç”¨äºè¿œç¨‹è¯»å–æ•°æ®æˆ–è®¾å¤‡ä¿¡æ¯

## å¾®ç”µè„‘æ—¶æ§å¼€å…³

[ZYT16Gå¾®ç”µè„‘æ—¶æ§å¼€å…³](https://toone.cn/ZYT16G%E5%BE%AE%E7%94%B5%E8%84%91%E6%97%B6%E6%8E%A7%E5%BC%80%E5%85%B3.html)

![ZYT16G](/images/hardware/cabinet/ZYT16G.jpg)

å®ƒæ˜¯ä¸€ç§ç”¨äºè‡ªåŠ¨æ§åˆ¶ç”µå™¨è®¾å¤‡åœ¨ç‰¹å®šæ—¶é—´å¼€å¯æˆ–å…³é—­çš„ç”µå­è®¾å¤‡ã€‚é€šè¿‡è®¾å®šæ—¶é—´å‚æ•°ï¼Œå®ƒå¯ä»¥æŒ‰ç…§é¢„è®¾çš„æ—¶é—´è¡¨è‡ªåŠ¨æ§åˆ¶ç”µè·¯çš„é€šæ–­ï¼Œé€‚ç”¨äºéœ€è¦å®šæ—¶æ§åˆ¶çš„åœºåˆï¼Œå¦‚è·¯ç¯ã€æ°´æ³µã€ç©ºè°ƒç­‰

## æ— äººæœºä¾›ç”µå’Œé”æ§æ¿

![power_lock_board](/images/hardware/cabinet/power_lock_board.jpg)

**ä¸»æ§èŠ¯ç‰‡STM32F103C8T6**

è¿™æ˜¯ STMicroelectronicsï¼ˆæ„æ³•åŠå¯¼ä½“ï¼‰ çš„ä¸€é¢— STM32F1 ç³»åˆ— ARM Cortex-M3 å†…æ ¸ MCUï¼Œå¸¸è§äºå·¥ä¸šæ§åˆ¶ã€ç‰©è”ç½‘å’Œæ™ºèƒ½è®¾å¤‡

* é€šè¿‡ RS-485 æˆ– UART ä¸ä¸Šä½æœºé€šè®¯
* æ§åˆ¶ MOSFET é©±åŠ¨é”ï¼ˆLK1~LK5ï¼‰
* è¯»å–é”çš„åé¦ˆä¿¡å·ï¼ˆFB1~FB5ï¼‰
* æ§åˆ¶ DC-DC è¾“å‡ºçŠ¶æ€
* ç›‘æµ‹ç”µå‹ã€ç”µæµçŠ¶æ€
* ç®¡ç† USB å£çš„ä¾›ç”µæ§åˆ¶

## ç”µæ± å……ç”µæ¿

![battery_board](/images/hardware/cabinet/battery_board.jpg)

è¿™å—ç”µè·¯æ¿æ˜¯ä¸€ä¸ªå¤šé€šé“çš„ç”µæºç®¡ç†æ¿ï¼Œå¾ˆå¯èƒ½ç”¨äºç”µæ± å……ç”µæˆ–å¹³è¡¡åº”ç”¨ã€‚å®ƒé€šè¿‡å…­ä¸ªç‹¬ç«‹çš„é™å‹/å‡å‹æ¨¡å—ï¼Œç”±ä¸€ä¸ªä¸­å¤®æ§åˆ¶å™¨è¿›è¡Œç®¡ç†ã€‚

**ä¸»æ§èŠ¯ç‰‡STM32F103C8T6**

USB-Aå£å¯èƒ½çš„ä½œç”¨ï¼š 
CDC (Communication Device Class)ï¼š æ¨¡æ‹Ÿä¸€ä¸ªä¸²å£ï¼ˆSerial Portï¼‰ã€‚è¿™æ˜¯æœ€ç®€å•ä¹Ÿæœ€å¸¸ç”¨çš„æ–¹æ³•ã€‚ç”µè·¯æ¿å‘å®‰å“å±å¹•â€œæŠ¥å‘Šâ€è‡ªå·±æ˜¯ä¸€ä¸ªè™šæ‹Ÿä¸²å£ï¼Œç„¶åå°±å¯ä»¥åƒä¼ ç»Ÿçš„ä¸²å£é€šä¿¡ä¸€æ ·ï¼Œé€šè¿‡æ”¶å‘å­—ç¬¦ä¸²æˆ–äºŒè¿›åˆ¶æ•°æ®æ¥äº¤æ¢ä¿¡æ¯

## è¯»å¡å™¨æ§åˆ¶æ¿

![rfid](/images/hardware/cabinet/rfid.jpg)

è¿™å—å°æ¿å­æ˜¯ä¸€ä¸ªRFIDè¯»å¡å™¨æ¨¡å—ã€‚å®ƒçš„ä½œç”¨æ˜¯ï¼š

* å°„é¢‘æ”¶å‘ï¼š é€šè¿‡æ¿å­å†…éƒ¨çš„PCBå¤©çº¿ï¼ˆå›¾ç‰‡ä¸­æ²¡æœ‰æ˜æ˜¾çš„å¤©çº¿çº¿åœˆï¼Œä½†å¤©çº¿å¯èƒ½é›†æˆåœ¨æ¿å­å†…å±‚ï¼Œæˆ–é€šè¿‡æ—è¾¹çš„ç”µæ„ŸL1/L2è¿›è¡ŒåŒ¹é…ï¼‰ï¼Œå®ƒèƒ½äº§ç”Ÿ13.56 MHzçš„å°„é¢‘åœºã€‚
* å¡ç‰‡æ„Ÿåº”ï¼š å½“å…¼å®¹çš„RFIDæ ‡ç­¾ï¼ˆå¦‚MIFAREå¡ï¼‰é è¿‘æ—¶ï¼Œå®ƒä¼šæ„Ÿåº”åˆ°å¡ç‰‡çš„ä¿¡å·ã€‚
* æ•°æ®è¯»å†™ï¼š é€šè¿‡æ„Ÿåº”åˆ°çš„ä¿¡å·ï¼Œå®ƒèƒ½è¯»å–æˆ–å†™å…¥å¡ç‰‡ä¸­çš„æ•°æ®ã€‚
* é€šä¿¡æ¥å£ï¼š é€šè¿‡åº•éƒ¨çš„4é’ˆè¿æ¥å™¨ï¼Œå®ƒä¸ä¸»æ§æ¿ï¼ˆä¾‹å¦‚ä½ ä¹‹å‰ä¸Šä¼ çš„ç”µæ± æ¿æˆ–æ§åˆ¶æ¿ï¼‰è¿›è¡Œé€šä¿¡ï¼Œé€šå¸¸é‡‡ç”¨SPIæˆ–I2Cåè®®ï¼Œå°†è¯»åˆ°çš„æ•°æ®å‘é€ç»™ä¸»æ§èŠ¯ç‰‡ï¼Œæˆ–è€…æ¥æ”¶ä¸»æ§èŠ¯ç‰‡çš„æŒ‡ä»¤å»å†™å…¥æ•°æ®ã€‚

![uart_24](/images/hardware/cabinet/uart_24.jpg)

**ä¸»æ§èŠ¯ç‰‡Geehy APM32 F072RBT6**

* ç”¨æˆ·å°†RFIDå¡é è¿‘è¯»å¡å™¨æ¨¡å—ï¼ˆANT522-M2ï¼‰ã€‚
* è¯»å¡å™¨æ¨¡å—è¯»å–å¡ç‰‡ä¸Šçš„å”¯ä¸€IDæˆ–æ•°æ®ã€‚
* è¯»å¡å™¨æ¨¡å—é€šè¿‡SPIæˆ–I2Cæ¥å£å°†æ•°æ®å‘é€ç»™24è·¯æ¿å­ä¸Šçš„ä¸»æ§èŠ¯ç‰‡ã€‚
* ä¸»æ§èŠ¯ç‰‡ï¼ˆAPM32ï¼‰æ ¹æ®å¡ç‰‡IDï¼Œåœ¨ç¨‹åºä¸­è¿›è¡Œèº«ä»½éªŒè¯ã€‚
* å¦‚æœéªŒè¯é€šè¿‡ï¼Œä¸»æ§èŠ¯ç‰‡ä¼šæ§åˆ¶ç›¸åº”çš„è¾“å‡ºé€šé“ï¼ˆä¾‹å¦‚ï¼Œå¼€å¯ç¬¬5è·¯å’Œç¬¬12è·¯ï¼‰ï¼Œå¹¶ç‚¹äº®ç›¸åº”çš„LEDæŒ‡ç¤ºç¯ã€‚

## è½¯ä»¶é€»è¾‘

* android_serialport_api: ç”¨äºé€šè¿‡ä¸²å£ä¸å¤–éƒ¨ç¡¬ä»¶è®¾å¤‡è¿›è¡Œé€šä¿¡ã€‚
* com.alibaba.android.arouter: ä¸€ä¸ªAndroidè·¯ç”±æ¡†æ¶ã€‚
* com.bumptech.glide: ä¸€ä¸ªæµè¡Œçš„å›¾ç‰‡åŠ è½½å’Œç¼“å­˜åº“ã€‚
* com.google.zxing: ç”¨äºå¤„ç†æ¡å½¢ç å’ŒäºŒç»´ç çš„åº“ã€‚
* com.tendcloud.tenddata: ç§»åŠ¨åº”ç”¨æ•°æ®åˆ†æå¹³å°ã€‚
* com.youth.banner: ä¸€ä¸ªç”¨äºåˆ›å»ºæ¨ªå¹…è§†å›¾çš„åº“ã€‚
* com.zhy.view.flowlayout: ä¸€ä¸ªç”¨äºå®ç°æµå¼å¸ƒå±€çš„åº“ã€‚
* io.reactivex: ç”¨äºå®ç°å“åº”å¼ç¼–ç¨‹çš„åº“ã€‚

## è½¯ä»¶éœ€æ±‚-1

android app äº§å“éœ€æ±‚ï¼š

1. appå¯åŠ¨åå…ˆå…¨å±æ’­æ”¾ä¸€ä¸ªæœ¬åœ°å‡†å¤‡å¥½çš„mp4è§†é¢‘(å¾ªç¯æ’­æ”¾)
2. è§†é¢‘ç•Œé¢çš„åº•éƒ¨æ˜¾ç¤ºå½“å‰è®¾å¤‡çš„æ— çº¿ä¿¡å·å’Œè®¾å¤‡åºåˆ—å·ï¼Œå†…å®¹æ‚¬æµ®åœ¨è§†é¢‘ä¸Šæ–¹æ˜¾ç¤º
3. appå¯åŠ¨çš„åŒæ—¶è¯·æ±‚æ¥å£ï¼Œå¦‚æœæ¥å£è¿”å›æœ‰æ–°çš„è§†é¢‘æ–‡ä»¶éœ€è¦ä¸‹è½½ï¼Œåˆ™ä¸‹è½½æ–°çš„è§†é¢‘æ–‡ä»¶
4. æ–°çš„è§†é¢‘æ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°åæ›¿æ¢æ‰åˆå§‹çš„è§†é¢‘æ–‡ä»¶æ’­æ”¾æ˜¾ç¤º
5. appå¯åŠ¨åè¿æ¥åˆ°åå°çš„MQTTæœåŠ¡
6. appå¯åŠ¨åæ‰“å¼€RS485ä¸²å£ttyS3, è¯»å–ä¸²å£è®¾å¤‡ä¿¡æ¯å¹¶é€šè¿‡mqttä¸ŠæŠ¥
7. appå¯åŠ¨åæ‰“å¼€TTLä¸²å£ttyS7, è¯»å–ä¸²å£ä¿¡æ¯å¹¶é€šè¿‡mqttä¸ŠæŠ¥
8. æœåŠ¡å™¨ä¸‹å‘æŒ‡ä»¤ï¼Œç„¶åé€šè¿‡ä¸²å£å‘é€æŒ‡ä»¤åˆ°ä¸²å£è®¾å¤‡ï¼Œä¸²å£è®¾å¤‡åé¦ˆç»“æœæ›´æ–°åˆ°UI
9. ä¸²å£è®¾å¤‡ä¸»åŠ¨ä¸ŠæŠ¥ä¿¡æ¯ä¹Ÿéœ€è¦æ›´æ–°UI

å¸®æˆ‘è®¾è®¡ä¸ªå®ç°ä¸Šè¿°éœ€æ±‚çš„æ¶æ„

**æ¶æ„è®¾è®¡**

```diff

+----------------------------------------------------------------------------------------------+
|                                      Android App                                             |
+----------------------+----------------------+----------------------+-----------------------+
|       UI å±‚          |     è§†é¢‘æ’­æ”¾å±‚       |      åå°æœåŠ¡å±‚       |   ä¸²å£ & MQTTå±‚       |
+----------------------+----------------------+----------------------+-----------------------+
| SplashVideoActivity  | VideoManager         | ApiService            | MqttManager           |
| - å…¨å±æ’­æ”¾è§†é¢‘       | - æ’­æ”¾æœ¬åœ°è§†é¢‘       | - è¯·æ±‚è§†é¢‘æ›´æ–°æ¥å£    | - è¿æ¥ MQTT Broker    |
| - åº•éƒ¨æ‚¬æµ®UIæ˜¾ç¤º    | - å¾ªç¯æ’­æ”¾           | DownloadService       | - ä¸ŠæŠ¥ä¸²å£æ•°æ®        |
|   WiFi & è®¾å¤‡åºåˆ—å· | - åˆ‡æ¢æ–°è§†é¢‘æº       | - æ ¡éªŒæ–‡ä»¶å®Œæ•´æ€§      | - æ¥æ”¶æœåŠ¡å™¨æŒ‡ä»¤      |
| - æ›´æ–°UIæ˜¾ç¤ºä¸²å£æ•°æ® |                      | - æ›¿æ¢æœ¬åœ°è§†é¢‘        | - å°†æŒ‡ä»¤ä¸‹å‘åˆ°ä¸²å£    |
|                      |                      |                      | - ä¸²å£åé¦ˆæ›´æ–°UI       |
+----------------------+----------------------+----------------------+-----------------------+
| æ•°æ®å­˜å‚¨å±‚           |
+----------------------+
| FileStorage          |
| - /files/video.mp4   |
| - /cache/new_video.mp4|
+----------------------+


```

**æ—¶åºå›¾**

```scss

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SplashVideoActivity â”‚       â”‚ ExoPlayer æ’­æ”¾å™¨ â”‚       â”‚ ApiService æ¥å£å±‚ â”‚       â”‚ DownloadService ä¸‹è½½å™¨ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                         â”‚                         â”‚                          â”‚
          â”‚ 1. å¯åŠ¨ Activity        â”‚                         â”‚                          â”‚
          â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                         â”‚                          â”‚
          â”‚                         â”‚                         â”‚                          â”‚
          â”‚ 2. åŠ è½½æœ¬åœ° video.mp4   â”‚                         â”‚                          â”‚
          â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                         â”‚                          â”‚
          â”‚                         â”‚                         â”‚                          â”‚
          â”‚                         â”‚ 3. å¾ªç¯æ’­æ”¾(REPEAT_ALL) â”‚                          â”‚
          â”‚                         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                          â”‚
          â”‚                         â”‚                         â”‚                          â”‚
          â”‚ 4. å¹¶å‘å‘èµ·æ¥å£è¯·æ±‚     â”‚                         â”‚                          â”‚
          â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                          â”‚
          â”‚                         â”‚                         â”‚                          â”‚
          â”‚                         â”‚                         â”‚ 5. è¿”å›æ–°è§†é¢‘ä¸‹è½½åœ°å€    â”‚
          â”‚                         â”‚                         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
          â”‚                         â”‚                         â”‚                          â”‚
          â”‚                         â”‚                         â”‚                          â”‚ 6. ä¸‹è½½æ–°è§†é¢‘åˆ°ç¼“å­˜
          â”‚                         â”‚                         â”‚                          â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶
          â”‚                         â”‚                         â”‚                          â”‚
          â”‚                         â”‚                         â”‚                          â”‚ 7. æ ¡éªŒ MD5 é€šè¿‡
          â”‚                         â”‚                         â”‚                          â”‚
          â”‚                         â”‚                         â”‚                          â”‚ 8. æ›¿æ¢æœ¬åœ° video.mp4
          â”‚                         â”‚                         â”‚                          â”‚
          â”‚                         â”‚ 9. åˆ‡æ¢æ’­æ”¾æº setMediaItem(new.mp4)                â”‚
          â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                         â”‚                          â”‚
          â”‚                         â”‚                         â”‚                          â”‚
          â”‚ 10. å¾ªç¯æ’­æ”¾æ–°è§†é¢‘       â”‚                         â”‚                          â”‚
          â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                         â”‚                          â”‚


```

**æ³³é“å›¾**

![drone_cabinet](/images/hardware/cabinet/drone_cabinet.png)

**ç”¨åˆ°çš„åº“**

| åŠŸèƒ½æ¨¡å—      | åº“/ç»„ä»¶                              | è¯´æ˜                       |
| --------- | --------------------------------- | ------------------------ |
| è§†é¢‘æ’­æ”¾      | ExoPlayer                         | å¾ªç¯æ’­æ”¾æœ¬åœ°è§†é¢‘ï¼Œå¯åŠ¨æ€åˆ‡æ¢è§†é¢‘æº        |
| ç½‘ç»œè¯·æ±‚      | Retrofit + OkHttp                 | è¯·æ±‚è§†é¢‘æ›´æ–°æ¥å£                 |
| åå°ä¸‹è½½      | WorkManager / ForegroundService   | ä¸‹è½½æ–°è§†é¢‘åˆ°ç¼“å­˜å¹¶æ›¿æ¢              |
| JSONè§£æ    | Gson / Moshi                      | è§£ææ¥å£è¿”å›ä¿¡æ¯                 |
| UIå¸ƒå±€      | ConstraintLayout / FrameLayout    | è§†é¢‘ä¸Šæ–¹æ‚¬æµ®æ˜¾ç¤º WiFi & åºåˆ—å·å’Œä¸²å£æ•°æ® |
| WiFi/è®¾å¤‡ä¿¡æ¯ | Android åŸç”Ÿ API                    | è·å–ä¿¡å·å¼ºåº¦å’Œè®¾å¤‡åºåˆ—å·             |
| MQTTé€šä¿¡    | Eclipse Paho / HiveMQ MQTT Client | ä¸ŠæŠ¥ä¸²å£æ•°æ®ï¼Œæ¥æ”¶æœåŠ¡å™¨æŒ‡ä»¤           |
| ä¸²å£æ“ä½œ      | jSerialComm / Android NDK         | æ‰“å¼€ ttyS3 / ttyS7ï¼Œè¯»å†™æ•°æ®    |
| UIæ•°æ®ç»‘å®š    | LiveData / StateFlow / Flow       | å®æ—¶æ›´æ–° UI æ˜¾ç¤ºä¸²å£æ•°æ®å’Œåé¦ˆç»“æœ      |

**æ—¶åºå›¾**

![drone_cabinet_2](/images/hardware/cabinet/drone_cabinet_2.png)

![drone_cabinet_3](/images/hardware/cabinet/drone_cabinet_3.png)

## A133 è§†é¢‘ç¼–è§£ç 

![a133_soc_diagram](/images/hardware/cabinet/a133_soc_diagram.png)

**A133æ”¯æŒçš„ç¡¬ä»¶ç¼–è§£ç èƒ½åŠ›ï¼š**

* è§†é¢‘ç¼–ç èƒ½åŠ›ï¼š H.264 çš„æœ€å¤§ç¼–ç æ€§èƒ½ä¸º 1080p@60fpsã€‚
* è§†é¢‘è§£ç èƒ½åŠ›ï¼š HEVC (H.265) å’Œ H.264 çš„æœ€å¤§è§£ç æ€§èƒ½ä¸º 4K@30fpsã€‚

### æŸ¥çœ‹è§†é¢‘æºä¿¡æ¯

sudo snap install mediainfo

mediainfo test_30fps.mp4

### æŠ¥é”™-1

![player_video_error](/images/hardware/cabinet/player_video_error.png)

**ä¿®æ”¹è§†é¢‘å¸§ç‡å‘½ä»¤**

ffmpeg -i test_60fps.mp4 -vf "fps=30" -c:a copy test_30fps.mp4

**ä¿®æ”¹åçš„è§†é¢‘æºä¿¡æ¯**

mediainfo test_30fps.mp4

```txt

General
Complete name                            : test_30fps.mp4       # æ–‡ä»¶å®Œæ•´è·¯å¾„å’Œæ–‡ä»¶å
Format                                   : MPEG-4               # å®¹å™¨æ ¼å¼
Format profile                           : Base Media           # å®¹å™¨ç±»å‹çš„è¯¦ç»†å­ç±»å‹
Codec ID                                 : isom (isom/iso2/avc1/mp41)  # å®¹å™¨æ ‡è¯†åŠå…¼å®¹æ€§
File size                                : 13.8 MiB             # æ–‡ä»¶å¤§å°
Duration                                 : 36 s 270 ms          # è§†é¢‘æ€»æ—¶é•¿
Overall bit rate                         : 3 202 kb/s           # å¹³å‡ç ç‡ï¼ŒåŒ…æ‹¬éŸ³è§†é¢‘
Frame rate                               : 30.000 FPS           # å®¹å™¨æ ‡è¯†çš„å¸§ç‡
Writing application                      : Lavf58.76.100        # ç”Ÿæˆæ–‡ä»¶æ‰€ç”¨çš„ç¨‹åº/åº“ç‰ˆæœ¬

Video
ID                                       : 1                     # è§†é¢‘æµID
Format                                   : AVC                   # è§†é¢‘ç¼–ç æ ¼å¼ï¼ˆH.264ï¼‰
Format/Info                              : Advanced Video Codec  # ç¼–ç æ ¼å¼è¯´æ˜
Format profile                           : High@L4               # H.264ç¼–ç Profileå’ŒLevel
Format settings                          : CABAC / 4 Ref Frames  # ç¼–ç è®¾ç½®ï¼šCABACå¼€å¯ã€å‚è€ƒå¸§æ•°4
Format settings, CABAC                   : Yes                   # æ˜¯å¦ä½¿ç”¨CABACç†µç¼–ç 
Format settings, Reference frames        : 4 frames              # ä½¿ç”¨çš„å‚è€ƒå¸§æ•°é‡
Codec ID                                 : avc1                  # ç¼–ç å™¨æ ‡è¯†
Codec ID/Info                            : Advanced Video Coding  # ç¼–ç å™¨è¯´æ˜
Duration                                 : 36 s 267 ms           # è§†é¢‘æµæ—¶é•¿
Bit rate                                 : 3 000 kb/s            # è§†é¢‘æµç ç‡
Width                                    : 1 080 pixels          # è§†é¢‘å®½åº¦
Height                                   : 1 920 pixels          # è§†é¢‘é«˜åº¦ï¼ˆç«–å±ï¼‰
Display aspect ratio                     : 9:16                  # æ˜¾ç¤ºå®½é«˜æ¯”
Frame rate mode                          : Constant              # å¸§ç‡æ¨¡å¼ï¼ˆæ’å®š/å¯å˜ï¼‰
Frame rate                               : 30.000 FPS            # å¸§ç‡
Color space                              : YUV                   # è‰²å½©ç©ºé—´
Chroma subsampling                       : 4:2:0                 # è‰²åº¦é‡‡æ ·æ ¼å¼
Bit depth                                : 8 bits                # æ¯ä¸ªé€šé“çš„ä½æ·±
Scan type                                : Progressive           # æ‰«ææ–¹å¼ï¼ˆé€è¡Œæ‰«æï¼‰
Bits/(Pixel*Frame)                       : 0.048                 # æ¯åƒç´ æ¯å¸§å¹³å‡æ¯”ç‰¹æ•°
Stream size                              : 13.0 MiB (94%)        # è§†é¢‘æµåœ¨æ–‡ä»¶ä¸­å æ¯”
Writing library                          : x264 core 163 r3060 5db6aa6  # ä½¿ç”¨çš„ç¼–ç åº“ç‰ˆæœ¬
Encoding settings                        : ...                    # ç¼–ç å™¨è¯¦ç»†å‚æ•°
Color range                              : Limited               # è‰²å½©èŒƒå›´ï¼ˆæœ‰é™/å…¨é‡ï¼‰
Color primaries                          : BT.709                # è‰²å½©åŸºå‡†
Transfer characteristics                 : BT.709                # ä¼ è¾“ç‰¹æ€§
Matrix coefficients                      : BT.709                # è‰²å½©çŸ©é˜µ
Codec configuration box                  : avcC                  # H.264 codec box é…ç½®

Audio
ID                                       : 2                     # éŸ³é¢‘æµID
Format                                   : AAC LC                # éŸ³é¢‘ç¼–ç æ ¼å¼ï¼ˆAAC Low Complexityï¼‰
Format/Info                              : Advanced Audio Codec Low Complexity  # ç¼–ç è¯´æ˜
Codec ID                                 : mp4a-40-2             # ç¼–ç å™¨æ ‡è¯†
Duration                                 : 36 s 270 ms           # éŸ³é¢‘æµæ—¶é•¿
Source duration                          : 36 s 292 ms           # åŸå§‹éŸ³é¢‘æµæ—¶é•¿
Bit rate mode                            : Constant              # ç ç‡æ¨¡å¼ï¼ˆCBR/æ’å®šç ç‡ï¼‰
Bit rate                                 : 192 kb/s              # éŸ³é¢‘ç ç‡
Channel(s)                               : 2 channels            # å£°é“æ•°
Channel layout                           : L R                   # å£°é“å¸ƒå±€
Sampling rate                            : 44.1 kHz              # é‡‡æ ·ç‡
Frame rate                               : 43.066 FPS (1024 SPF) # æ¯å¸§é‡‡æ ·æ•°/å¸§ç‡
Compression mode                         : Lossy                  # å‹ç¼©æ–¹å¼ï¼ˆæœ‰æŸ/æ— æŸï¼‰
Stream size                              : 858 KiB (6%)           # éŸ³é¢‘æµåœ¨æ–‡ä»¶ä¸­å æ¯”
Source stream size                       : 858 KiB (6%)           # åŸå§‹éŸ³é¢‘æµå¤§å°
Default                                  : Yes                     # é»˜è®¤æµ
Alternate group                          : 1                       # æµç»„ID
mdhd_Duration                            : 36269                   # åª’ä½“headeré‡Œçš„æ—¶é•¿ï¼ˆå•ä½msï¼‰

```

### æŠ¥é”™-2

```txt

ACodec                  E  signalError(omxError 0x80001001, internalError -62)
MediaCodec              E  Codec reported err 0xffffffc2, actionCode 0, while in state 6
ACodec                  W  not dequeuing from native window due to fatal error
ACodec                  W  not dequeuing from native window due to fatal error
SurfaceUtils            D  disconnecting from surface 0xc5137808, reason disconnectFromSurface
ACodec                  W  not dequeuing from native window due to fatal error
MediaCodecVideoRenderer E  Video codec error (Ask Gemini)
                java.lang.IllegalStateException
		at android.media.MediaCodec.native_dequeueOutputBuffer(Native Method)
		at android.media.MediaCodec.dequeueOutputBuffer(MediaCodec.java:2789)
		at androidx.media3.exoplayer.mediacodec.SynchronousMediaCodecAdapter.dequeueOutputBufferIndex(SynchronousMediaCodecAdapter.java:112)
		at androidx.media3.exoplayer.mediacodec.MediaCodecRenderer.drainOutputBuffer(MediaCodecRenderer.java:2104)
		at androidx.media3.exoplayer.mediacodec.MediaCodecRenderer.render(MediaCodecRenderer.java:896)
		at androidx.media3.exoplayer.video.MediaCodecVideoRenderer.render(MediaCodecVideoRenderer.java:1314)
		at androidx.media3.exoplayer.RendererHolder.render(RendererHolder.java:391)
		at androidx.media3.exoplayer.ExoPlayerImplInternal.doSomeWork(ExoPlayerImplInternal.java:1367)
		at androidx.media3.exoplayer.ExoPlayerImplInternal.handleMessage(ExoPlayerImplInternal.java:697)
		at android.os.Handler.dispatchMessage(Handler.java:103)
		at android.os.Looper.loop(Looper.java:214)
		at android.os.HandlerThread.run(HandlerThread.java:67)

ExoPlayerImplInternal   E  Playback error (Ask Gemini)
		androidx.media3.exoplayer.ExoPlaybackException: MediaCodecVideoRenderer error, index=0, format=Format(1, null, video/mp4, video/avc, avc1.640028, 2999664, und, [1080, 1920, 30.000004, ColorInfo(BT709, Limited range, SDR SMPTE 170M, false, 8bit Luma, 8bit Chroma)], [-1, -1]), format_supported=YES
		at androidx.media3.exoplayer.BaseRenderer.createRendererException(BaseRenderer.java:545)
		at androidx.media3.exoplayer.mediacodec.MediaCodecRenderer.render(MediaCodecRenderer.java:926)
		at androidx.media3.exoplayer.video.MediaCodecVideoRenderer.render(MediaCodecVideoRenderer.java:1314)
		at androidx.media3.exoplayer.RendererHolder.render(RendererHolder.java:391)
		at androidx.media3.exoplayer.ExoPlayerImplInternal.doSomeWork(ExoPlayerImplInternal.java:1367)
		at androidx.media3.exoplayer.ExoPlayerImplInternal.handleMessage(ExoPlayerImplInternal.java:697)
		at android.os.Handler.dispatchMessage(Handler.java:103)
		at android.os.Looper.loop(Looper.java:214)
		at android.os.HandlerThread.run(HandlerThread.java:67)
		Caused by: androidx.media3.exoplayer.video.MediaCodecVideoDecoderException: Decoder failed: OMX.allwinner.video.decoder.avc
		at androidx.media3.exoplayer.video.MediaCodecVideoRenderer.createDecoderException(MediaCodecVideoRenderer.java:2468)
		at androidx.media3.exoplayer.mediacodec.MediaCodecRenderer.render(MediaCodecRenderer.java:920)
		at androidx.media3.exoplayer.video.MediaCodecVideoRenderer.render(MediaCodecVideoRenderer.java:1314)Â 
		at androidx.media3.exoplayer.RendererHolder.render(RendererHolder.java:391)Â 
		at androidx.media3.exoplayer.ExoPlayerImplInternal.doSomeWork(ExoPlayerImplInternal.java:1367)Â 
		at androidx.media3.exoplayer.ExoPlayerImplInternal.handleMessage(ExoPlayerImplInternal.java:697)Â 
		at android.os.Handler.dispatchMessage(Handler.java:103)Â 
		at android.os.Looper.loop(Looper.java:214)Â 
		at android.os.HandlerThread.run(HandlerThread.java:67)Â 
		Caused by: java.lang.IllegalStateException
		at android.media.MediaCodec.native_dequeueOutputBuffer(Native Method)
		at android.media.MediaCodec.dequeueOutputBuffer(MediaCodec.java:2789)
		at androidx.media3.exoplayer.mediacodec.SynchronousMediaCodecAdapter.dequeueOutputBufferIndex(SynchronousMediaCodecAdapter.java:112)
		at androidx.media3.exoplayer.mediacodec.MediaCodecRenderer.drainOutputBuffer(MediaCodecRenderer.java:2104)
		at androidx.media3.exoplayer.mediacodec.MediaCodecRenderer.render(MediaCodecRenderer.java:896)
		at androidx.media3.exoplayer.video.MediaCodecVideoRenderer.render(MediaCodecVideoRenderer.java:1314)Â 
		at androidx.media3.exoplayer.RendererHolder.render(RendererHolder.java:391)Â 
		at androidx.media3.exoplayer.ExoPlayerImplInternal.doSomeWork(ExoPlayerImplInternal.java:1367)Â 
		at androidx.media3.exoplayer.ExoPlayerImplInternal.handleMessage(ExoPlayerImplInternal.java:697)Â 
		at android.os.Handler.dispatchMessage(Handler.java:103)Â 
		at android.os.Looper.loop(Looper.java:214)Â 
		at android.os.HandlerThread.run(HandlerThread.java:67)Â 
ExoPlayerImplInternal   E  Disable failed. (Ask Gemini)
		java.lang.IllegalStateException
		at android.media.MediaCodec.native_flush(Native Method)
		at android.media.MediaCodec.flush(MediaCodec.java:2194)
		at androidx.media3.exoplayer.mediacodec.SynchronousMediaCodecAdapter.flush(SynchronousMediaCodecAdapter.java:160)
		at androidx.media3.exoplayer.mediacodec.MediaCodecRenderer.flushCodec(MediaCodecRenderer.java:1033)
		at androidx.media3.exoplayer.mediacodec.MediaCodecRenderer.flushOrReleaseCodec(MediaCodecRenderer.java:964)
		at androidx.media3.exoplayer.mediacodec.MediaCodecRenderer.onDisabled(MediaCodecRenderer.java:797)
		at androidx.media3.exoplayer.video.MediaCodecVideoRenderer.onDisabled(MediaCodecVideoRenderer.java:1081)
		at androidx.media3.exoplayer.BaseRenderer.disable(BaseRenderer.java:247)
		at androidx.media3.exoplayer.RendererHolder.disableRenderer(RendererHolder.java:673)
		at androidx.media3.exoplayer.RendererHolder.disable(RendererHolder.java:567)
		at androidx.media3.exoplayer.ExoPlayerImplInternal.disableRenderer(ExoPlayerImplInternal.java:2164)
		at androidx.media3.exoplayer.ExoPlayerImplInternal.disableRenderers(ExoPlayerImplInternal.java:2157)
		at androidx.media3.exoplayer.ExoPlayerImplInternal.resetInternal(ExoPlayerImplInternal.java:1890)
		at androidx.media3.exoplayer.ExoPlayerImplInternal.stopInternal(ExoPlayerImplInternal.java:1847)
		at androidx.media3.exoplayer.ExoPlayerImplInternal.handleMessage(ExoPlayerImplInternal.java:876)
		at android.os.Handler.dispatchMessage(Handler.java:103)
		at android.os.Looper.loop(Looper.java:214)
		at android.os.HandlerThread.run(HandlerThread.java:67)
Surface                 E  getSlotFromBufferLocked: unknown buffer: 0xc4ea98c0
ACodec                  W  [OMX.allwinner.video.decoder.avc] can not return buffer 22 to native window
Surface                 E  getSlotFromBufferLocked: unknown buffer: 0xc4ea91c0
ACodec                  W  [OMX.allwinner.video.decoder.avc] can not return buffer 17 to native window
Surface                 E  getSlotFromBufferLocked: unknown buffer: 0xeefe9900
ACodec                  W  [OMX.allwinner.video.decoder.avc] can not return buffer 16 to native window

```

**å½“å‰ä¿®æ”¹æ–¹æ¡ˆ**

å®šæ—¶é‡å»ºexoplayer

### æŠ¥é”™-3

```txt

09-02 14:02:04.080 2055 10373 W cedarc : <RequestVideoStreamBuffer:1318>: request stream buffer fail, 8310743 bytes valid data in SBM[0], total buffer size is 8388608 bytes.
09-02 14:02:04.080 2055 10373 E omx_vdec_aw: <__anSubmit:2865>: [40;31mreq vbs fail! maybe vbs buffer is full!

```

**æŠ¥é”™çš„è§†é¢‘æºä¿¡æ¯**

mediainfo test-2802.mp4

```txt

General
Complete name                            : test-2802.mp4      # æ–‡ä»¶å
Format                                   : MPEG-4             # å®¹å™¨æ ¼å¼
Format profile                           : Base Media         # å®¹å™¨å­ç±»å‹
Codec ID                                 : isom (isom/iso2/avc1/mp41)  # å®¹å™¨æ ‡è¯†
File size                                : 31.6 MiB           # æ–‡ä»¶å¤§å°
Duration                                 : 39 s 851 ms        # æ€»æ—¶é•¿
Overall bit rate mode                    : Variable           # ç ç‡æ¨¡å¼
Overall bit rate                         : 6 643 kb/s         # å¹³å‡ç ç‡
Frame rate                               : 30.000 FPS         # å¸§ç‡
Encoded date                             : 2025-09-01 07:08:04 UTC  # ç¼–ç æ—¶é—´
Tagged date                              : 2025-09-01 07:08:16 UTC  # æ ‡ç­¾æ—¶é—´
Hw                                       : 1                  # ç¡¬ä»¶åŠ é€Ÿæ ‡è®°
bitrate                                  : 8000000            # è§†é¢‘ç›®æ ‡ç ç‡
encoder                                  : Lavf61.1.100       # ç¼–ç å™¨

Video
ID                                       : 1                  # è§†é¢‘æµID
Format                                   : AVC                # è§†é¢‘ç¼–ç ï¼ˆH.264ï¼‰
Format/Info                              : Advanced Video Codec  # ç¼–ç è¯´æ˜
Format profile                           : Main@L4            # H.264 Profile/Level
Format settings                          : CABAC / 4 Ref Frames  # CABACåŠå‚è€ƒå¸§
Format settings, CABAC                   : Yes                # æ˜¯å¦å¼€å¯CABAC
Format settings, Reference frames        : 4 frames           # å‚è€ƒå¸§æ•°é‡
Codec ID                                 : avc1               # ç¼–ç æ ‡è¯†
Codec ID/Info                            : Advanced Video Coding  # ç¼–ç è¯´æ˜
Duration                                 : 39 s 834 ms        # è§†é¢‘æµæ—¶é•¿
Bit rate mode                            : Variable           # è§†é¢‘ç ç‡æ¨¡å¼
Bit rate                                 : 6 440 kb/s         # è§†é¢‘å¹³å‡ç ç‡
Maximum bit rate                         : 16.0 Mb/s          # æœ€å¤§ç ç‡
Width                                    : 1 080 pixels       # å®½åº¦
Height                                   : 1 920 pixels       # é«˜åº¦
Display aspect ratio                     : 9:16               # å®½é«˜æ¯”
Frame rate mode                          : Constant           # å¸§ç‡æ¨¡å¼
Frame rate                               : 30.000 FPS         # è§†é¢‘å¸§ç‡
Color space                              : YUV                # è‰²å½©ç©ºé—´
Chroma subsampling                       : 4:2:0              # è‰²åº¦é‡‡æ ·
Bit depth                                : 8 bits             # ä½æ·±
Scan type                                : Progressive        # æ‰«ææ–¹å¼
Bits/(Pixel*Frame)                       : 0.104              # æ¯åƒç´ æ¯å¸§æ¯”ç‰¹
Stream size                              : 30.6 MiB (97%)     # è§†é¢‘å æ–‡ä»¶æ¯”ä¾‹
Color range                              : Limited            # è‰²å½©èŒƒå›´
Color primaries                          : BT.709             # è‰²å½©åŸºå‡†
Transfer characteristics                 : BT.709             # ä¼ è¾“ç‰¹æ€§
Matrix coefficients                      : BT.709             # è‰²å½©çŸ©é˜µ
Codec configuration box                  : avcC               # H.264 codec box

Audio
ID                                       : 2                  # éŸ³é¢‘æµID
Format                                   : AAC LC             # éŸ³é¢‘ç¼–ç 
Format/Info                              : Advanced Audio Codec Low Complexity  # ç¼–ç è¯´æ˜
Codec ID                                 : mp4a-40-2          # ç¼–ç æ ‡è¯†
Duration                                 : 39 s 851 ms        # éŸ³é¢‘æ—¶é•¿
Source duration                          : 39 s 871 ms        # åŸå§‹éŸ³é¢‘æ—¶é•¿
Bit rate mode                            : Constant           # ç ç‡æ¨¡å¼
Bit rate                                 : 199 kb/s           # éŸ³é¢‘ç ç‡
Channel(s)                               : 2 channels         # å£°é“æ•°
Channel layout                           : L R                 # å£°é“å¸ƒå±€
Sampling rate                            : 48.0 kHz           # é‡‡æ ·ç‡
Frame rate                               : 46.875 FPS (1024 SPF) # éŸ³é¢‘å¸§ç‡
Compression mode                         : Lossy              # å‹ç¼©æ–¹å¼
Stream size                              : 970 KiB (3%)       # éŸ³é¢‘å æ–‡ä»¶æ¯”ä¾‹
Source stream size                       : 970 KiB (3%)       # åŸå§‹éŸ³é¢‘å¤§å°
Default                                  : Yes                # é»˜è®¤æ’­æ”¾æµ
Alternate group                          : 1                  # æµç»„ID
Encoded date                             : 2025-09-01 07:08:04 UTC  # ç¼–ç æ—¶é—´
Tagged date                              : 2025-09-01 07:08:16 UTC  # æ ‡ç­¾æ—¶é—´


```

**å¯¹æ¯”å·®å¼‚**

| å‚æ•°          | test-30fps.mp4 | test-2802.mp4 | è¯´æ˜ / å½±å“                              |
| ----------- | --------------- | ------------- | ------------------------------------ |
| æ–‡ä»¶å¤§å°        | 13.8 MiB        | 31.6 MiB      | æ–‡ä»¶å¤§çº¦æ˜¯ 2.3 å€ï¼Œå†…å­˜/å­˜å‚¨å ç”¨æ›´é«˜                |
| æ—¶é•¿          | 36 s            | 39 s 851 ms   | `test-2802.mp4` ç•¥é•¿                   |
| æ•´ä½“ç ç‡        | 3 202 kb/s      | 6 643 kb/s    | å¹³å‡ç ç‡é«˜çº¦ 2 å€ï¼Œå¯¹è§£ç å‹åŠ›å¤§                    |
| è§†é¢‘ç¼–ç Profile | High\@L4        | Main\@L4      | High Profile å¯¹æ—§ç¡¬ä»¶è¦æ±‚æ›´é«˜ï¼ˆA133æ”¯æŒHigh L4ï¼‰ |
| è§†é¢‘ç ç‡        | 3 000 kb/s      | 6 440 kb/s    | `test-2802.mp4` è§£ç è´Ÿè½½æ›´å¤§ï¼ŒSBMå‹åŠ›é«˜        |
| æœ€å¤§ç ç‡        | â€”               | 16.0 Mb/s     | é«˜å³°å€¼å¯èƒ½å¯¼è‡´ç¼“å†²ä¸è¶³æˆ–æ’­æ”¾å¤±è´¥                     |
| è§†é¢‘æµå æ¯”       | 94%             | 97%           | è§†é¢‘å æ¯”æ›´é«˜ï¼ŒéŸ³é¢‘å æ¯”æ›´å°                        |
| éŸ³é¢‘é‡‡æ ·ç‡       | 44.1 kHz        | 48 kHz        | å¯¹æ’­æ”¾å½±å“å°                               |
| éŸ³é¢‘ç ç‡        | 192 kb/s        | 199 kb/s      | å¯¹æ’­æ”¾å½±å“å°                               |

**å®‰å…¨å‚æ•°èŒƒå›´**

```txt

SBM ä½¿ç”¨ç‡ (%)
100 |                                â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  <- å±é™©åŒº (>90%)
 90 |                               â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   <- é»„è‰²è¾¹ç¼˜åŒº
 80 |                            â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
 70 |                         â–ˆâ–ˆâ–ˆâ–ˆ        <- æ¥è¿‘ä¸Šé™
 60 |                      â–ˆâ–ˆâ–ˆ           <- å®‰å…¨ä¸Šé™
 50 |                   â–ˆâ–ˆâ–ˆ
 40 |                â–ˆâ–ˆâ–ˆ
 30 |             â–ˆâ–ˆâ–ˆ
 20 |          â–ˆâ–ˆâ–ˆ
 10 |       â–ˆâ–ˆâ–ˆ
  0 |____â–ˆâ–ˆâ–ˆ______________________________
       0     4     6     8     12     16
           å¹³å‡ç ç‡ (Mbps)


```

* ç»¿è‰²åŒºï¼ˆ0â€“6 Mbpsï¼‰ï¼šæ’­æ”¾å®Œå…¨å®‰å…¨ï¼ŒSBM ä½¿ç”¨ç‡ 50â€“70%
* é»„è‰²åŒºï¼ˆ6â€“8 Mbpsï¼‰ï¼šæ’­æ”¾è¾¹ç¼˜ï¼ŒSBM æ¥è¿‘æ»¡
* çº¢è‰²åŒºï¼ˆ>8â€“16 Mbpsï¼‰ï¼šæ’­æ”¾é£é™©å¤§ï¼Œå³°å€¼ç ç‡é«˜å®¹æ˜“è§¦å‘ SBM æ»¡æŠ¥é”™

**ä¿®æ”¹è§†é¢‘ç ç‡**

```txt

ffmpeg -i test-2802.mp4 -c:v libx264 -b:v 5M -maxrate 8M -bufsize 8M -c:a copy output_2802_5mbps.mp4

```

**ä¿®æ”¹å‰åå¯¹æ¯”**

| å‚æ•°                  | ä¿®æ”¹å‰ `test-2802.mp4` | ä¿®æ”¹å `output_2802_5mbps.mp4` | å·®å¼‚è¯´æ˜                           |
| ------------------- | ------------------- | --------------------------- | ------------------------------ |
| æ–‡ä»¶å¤§å°                | 31.6 MiB            | 23.1 MiB                    | æ–‡ä»¶å‡å°ï¼Œç ç‡é™ä½                      |
| Overall bit rate    | 6,643 kb/s          | 4,863 kb/s                  | å¹³å‡ç ç‡é™ä½åˆ° 4.86 Mbpsï¼Œæ›´é€‚åˆ A133 SBM |
| è§†é¢‘ Bit rate         | 6,440 kb/s          | 4,656 kb/s                  | è§†é¢‘æµç ç‡é™ä½                        |
| è§†é¢‘ Nominal bit rate | 16,000 kb/s (å³°å€¼)    | 5,000 kb/s                  | å¹³å‡ç ç‡æ§åˆ¶ä¸º 5 Mbps                 |
| è§†é¢‘ Maximum bit rate | 16,000 kb/s         | 8,000 kb/s                  | å³°å€¼ç ç‡é™ä½ä¸€åŠï¼Œå‡å°‘ SBM ç¬æ—¶æ»¡é£é™©          |
| ç¼–ç è®¾ç½® RC æ¨¡å¼          | VBR (`rc=crf`)      | ABR (`rc=abr`)              | æ§åˆ¶ç ç‡æ”¹ä¸ºå¹³å‡ç ç‡æ¨¡å¼ï¼Œç¨³å®šæ’­æ”¾              |
| Stream size         | 30.6 MiB            | 22.1 MiB                    | è§†é¢‘å ç”¨ç©ºé—´å‡å°‘                       |
| Audio bit rate      | 199 kb/s â†’ æœªå˜åŒ–      | â€”                           | éŸ³é¢‘æœªé‡æ–°ç¼–ç                         |
| Overall æ–‡ä»¶å¤§å°å æ¯”      | 97% è§†é¢‘              | 96% è§†é¢‘                      | è§†é¢‘æ¯”ä¾‹ç•¥é™ä½                        |

**ç ç‡æ§åˆ¶æ¨¡å¼**

| RC æ¨¡å¼                         | å«ä¹‰     | ç‰¹ç‚¹                                                 |
| ----------------------------- | ------ | -------------------------------------------------- |
| **CRFï¼ˆConstant Rate Factorï¼‰** | æ’å®šè´¨é‡æ¨¡å¼ | ç¼–ç å™¨å°½é‡ä¿æŒè§†è§‰è´¨é‡æ’å®šï¼Œä½†ç ç‡ä¼šæ³¢åŠ¨ï¼Œå³°å€¼å¯èƒ½å¾ˆé«˜ã€‚é€‚åˆæ–‡ä»¶å¤§å°ä¸å›ºå®šçš„è§†é¢‘ã€‚          |
| **ABRï¼ˆAverage Bit Rateï¼‰**     | å¹³å‡ç ç‡æ¨¡å¼ | ç¼–ç å™¨æ§åˆ¶å¹³å‡ç ç‡è¾¾åˆ°æŒ‡å®šå€¼ï¼ŒåŒæ—¶å…è®¸çŸ­æ—¶é—´æ³¢åŠ¨ï¼Œä½†å³°å€¼å—é™ã€‚é€‚åˆæµåª’ä½“æˆ–è®¾å¤‡æ’­æ”¾ï¼Œå¯¹ç¼“å­˜å‹åŠ›å¯æ§ã€‚ |
| **CBRï¼ˆConstant Bit Rateï¼‰**    | æ’å®šç ç‡æ¨¡å¼ | æ¯å¸§è¾“å‡ºç ç‡å‡ ä¹å›ºå®šï¼Œæ’­æ”¾éå¸¸ç¨³å®šï¼Œä½†æ–‡ä»¶å¯èƒ½å¤§æˆ–ç”»è´¨ä¸å‡ã€‚                     |

```txt

æ¯å¸§ç ç‡ (Mbps)
20 |           â”€â”€â•®
18 |        â•­â”€â•¯ â•°â”€â•®   <- CRF é«˜å³°
16 |     â•­â”€â•¯      â•°â”€â•®
14 |  â•­â”€â•¯            â•°â”€â•®
12 |â•­â”€â•¯                â•°â”€â•®
10 |â•¯                      <- CRF æ³¢åŠ¨å¤§ï¼Œå³°å€¼å¯èƒ½å¡«æ»¡ SBM
 8 |â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  <- SBM ä¸Šé™
 6 |     â”‚
 4 |     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•® <- ABR å¹³å‡ç ç‡ 5 Mbps
 2 |     â”‚               â”‚
 0 |â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€
       æ—¶é—´ â†’

```











