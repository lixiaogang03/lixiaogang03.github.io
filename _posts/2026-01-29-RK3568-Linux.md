---
layout:     post
title:      RK3568 Linux
subtitle:   Buildroot Debian Ubuntu
date:       2026-01-29
author:     LXG
header-img: img/post-bg-sky.jpg
catalog: true
tags:
    - rk3568
    - linux
---

## buildroot debian ubuntu

| ç»´åº¦       | Buildroot  | Debian       | Ubuntu        |
| -------- | ---------- | ------------ | ------------- |
| å®šä½       | **å›ºä»¶ç”Ÿæˆå™¨**  | é€šç”¨ Linux å‘è¡Œç‰ˆ | å•†ä¸šåŒ–é€šç”¨å‘è¡Œç‰ˆ      |
| ç›®æ ‡       | åµŒå…¥å¼é‡äº§      | é€šç”¨ + åµŒå…¥å¼     | æ¡Œé¢ / æœåŠ¡å™¨ / AI |
| rootfs   | **æ•´ä½“ç”Ÿæˆ**   | åŒ…ç®¡ç†          | åŒ…ç®¡ç†           |
| åŒ…ç®¡ç†      | âŒ æ—  apt    | âœ… apt        | âœ… apt         |
| ç³»ç»Ÿä½“ç§¯     | **5~50MB** | 200MB+       | 1GB+          |
| å¯åŠ¨é€Ÿåº¦     | **æœ€å¿«ï¼ˆç§’çº§ï¼‰** | ä¸­ç­‰           | æœ€æ…¢            |
| å¯è£å‰ªæ€§     | **æé«˜**     | ä½            | å¾ˆä½            |
| å¯æ§æ€§      | **100%**   | 70%          | 50%           |
| é‡äº§å‹å¥½     | â­â­â­â­â­      | â­â­           | â­             |
| å­¦ä¹ æˆæœ¬     | é«˜          | ä½            | æœ€ä½            |
| é€‚åˆä½ è¿™ç§å·¥ç¨‹å¸ˆ | **éå¸¸é€‚åˆ**   | è°ƒè¯•èˆ’æœ         | å¶å°”ç”¨           |

## RK3568 æ— äººé€è´§å°è½¦

RK3568 + æ— äººé€è´§å°è½¦ + 2GB RAM / 16GB Flash

ğŸ‘‰ é¦–é€‰ï¼šBuildroot
ğŸ‘‰ è°ƒè¯•æœŸå¯ç”¨ï¼šDebian
âŒ ä¸å»ºè®®ï¼šUbuntu

**ä¸ºä»€ä¹ˆä¸æ¨è Debian ç›´æ¥é‡äº§**

| ç»´åº¦          | Debian | Buildroot |
| ----------- | ------ | --------- |
| å‡ºé—®é¢˜ä½ èƒ½å¦â€œä¸‹æ­»æ‰‹â€ | âŒ      | âœ…         |
| å¼ºåˆ¶å¤ä½ modem  | âŒ      | âœ…         |
| USB æ–­ç”µé‡æšä¸¾   | âŒ      | âœ…         |
| OTA å¯æ§      | âŒ      | âœ…         |
| ç³»ç»Ÿè¡Œä¸ºå¯é¢„æµ‹     | âŒ      | âœ…         |

## Buildroot 4G

/etc/ppp/peers/quectel-pppd.sh

```sh

#!/bin/sh
# ============================================================
# quectel-pppd.sh
# ç”¨äºé€šè¿‡ PPP æ‹¨å·è¿æ¥ Quectel 4G æ¨¡å—ï¼ˆttyUSB3ï¼‰
# å‚æ•°é¡ºåºï¼šdevname apn user password
# ============================================================

echo "quectel-pppd options in effect:"

# -----------------------------
# é»˜è®¤å€¼è®¾ç½®
# -----------------------------
QL_DEVNAME=/dev/ttyUSB1     # 4G æ¨¡å—å¯¹åº”ä¸²å£è®¾å¤‡
QL_APN=3gnet                # é»˜è®¤ APNï¼Œå¯æ ¹æ®è¿è¥å•†ä¿®æ”¹
QL_USER=user                # PPP ç”¨æˆ·åï¼ˆå¦‚æœéœ€è¦ï¼‰
QL_PASSWORD=passwd          # PPP å¯†ç ï¼ˆå¦‚æœéœ€è¦ï¼‰

# -----------------------------
# å‘½ä»¤è¡Œå‚æ•°è¦†ç›–é»˜è®¤å€¼
# -----------------------------
if [ $# -ge 1 ]; then
	QL_DEVNAME=$1
	echo "devname   $QL_DEVNAME    # (from command line)"
else
	echo "devname   $QL_DEVNAME    # (default)"
fi

if [ $# -ge 2 ]; then
	QL_APN=$2
	echo "apn       $QL_APN    # (from command line)"
else
	echo "apn       $QL_APN    # (default)"
fi

if [ $# -ge 3 ]; then
	QL_USER=$3
	echo "user      $QL_USER   # (from command line)"
else
	echo "user      $QL_USER   # (default)"
fi

if [ $# -ge 4 ]; then
	QL_PASSWORD=$4
	echo "password  $QL_PASSWORD   # (from command line)"
else
	echo "password  $QL_PASSWORD   # (default)"
fi

# -----------------------------
# chat å‘½ä»¤ï¼Œç”¨äºåˆå§‹åŒ– 4G æ¨¡å—å¹¶æ‹¨å·
# -----------------------------
CONNECT="'chat -s -v ABORT BUSY ABORT \"NO CARRIER\" ABORT \"NO DIALTONE\" ABORT ERROR ABORT \"NO ANSWER\" TIMEOUT 30 \
\"\" AT OK ATE0 OK ATI\;+CSUB\;+CSQ\;+CPIN?\;+COPS?\;+CGREG?\;\&D2 \
OK AT+CGDCONT=1,\\\"IP\\\",\\\"$QL_APN\\\",,0,0 OK ATD*99# CONNECT'"

# è§£é‡Šï¼š
# - chat -s -v : å®‰é™æ¨¡å¼å¹¶æ‰“å°è°ƒè¯•ä¿¡æ¯
# - ABORT â€¦ : é‡åˆ°è¿™äº›å…³é”®å­—å°±åœæ­¢æ‹¨å·
# - TIMEOUT 30 : æ¯æ­¥ç­‰å¾… 30 ç§’
# - AT OK â€¦ : å‘é€ AT æŒ‡ä»¤åˆå§‹åŒ–æ¨¡å—
#   - ATE0          : å…³é—­å›æ˜¾
#   - ATI / +CSUBâ€¦  : æŸ¥è¯¢æ¨¡å—ä¿¡æ¯ã€SIM çŠ¶æ€ã€ä¿¡å·è´¨é‡
#   - &D2           : è®¾ç½® DTR è¡Œæ–­å¼€æ¨¡å—å¤ä½
# - AT+CGDCONT=1,"IP","$QL_APN" : è®¾ç½® PDP Context
# - ATD*99#        : æ‹¨å·å»ºç«‹ PPP é“¾è·¯
# - CONNECT        : è¡¨ç¤º chat æˆåŠŸåè¿›å…¥ PPP è¿æ¥çŠ¶æ€

# -----------------------------
# å¯åŠ¨ pppd
# -----------------------------
pppd $QL_DEVNAME 115200 user "$QL_USER" password "$QL_PASSWORD" \
connect "'$CONNECT'" \
disconnect 'chat -s -v ABORT ERROR ABORT "NO DIALTONE" SAY "\nSending break to the modem\n" "" +++ "" +++ "" +++ SAY "\nGood bay\n"' \
noauth               # ä¸è¦æ±‚å¯¹ç«¯è®¤è¯
debug                # è¾“å‡ºè°ƒè¯•ä¿¡æ¯åˆ° stdout
defaultroute         # å°† PPP ç½‘å¡è®¾ç½®ä¸ºé»˜è®¤è·¯ç”±
noipdefault          # ä¸ä½¿ç”¨é»˜è®¤ IP
novj novjccomp noccp  # å…³é—­å‹ç¼©ï¼ˆVan Jacobson header & CCPï¼‰
ipcp-accept-local    # æ¥å—å¯¹ç«¯é…ç½®çš„æœ¬åœ° IP
ipcp-accept-remote   # æ¥å—å¯¹ç«¯é…ç½®çš„è¿œç«¯ IP
ipcp-max-configure 30 # æœ€å¤§ IPCP å°è¯•æ¬¡æ•°
local                 # å¼ºåˆ¶æœ¬åœ°æ¨¡å¼ï¼ˆä¸ä½¿ç”¨è°ƒåˆ¶è§£è°ƒå™¨æ§åˆ¶çº¿ï¼‰
lock                  # é”å®šä¸²å£ï¼Œé˜²æ­¢å¹¶å‘è®¿é—®
modem                 # ä½¿ç”¨è°ƒåˆ¶è§£è°ƒå™¨æ§åˆ¶ä¿¡å·
dump                  # è¾“å‡º PPP åè®®è°ƒè¯•ä¿¡æ¯
nodetach               # ä¸è„±ç¦»ç»ˆç«¯ï¼Œæ–¹ä¾¿åå°ç›‘æ§
nocrtscts              # ç¦ç”¨ç¡¬ä»¶æµæ§
usepeerdns             # ä½¿ç”¨å¯¹ç«¯æä¾›çš„ DNS
&                      # åå°æ‰§è¡Œ pppd

# ============================================================
# æ³¨æ„äº‹é¡¹ï¼ˆæ— äººè½¦é‡äº§éœ€è¦è€ƒè™‘ï¼‰
# 1. è„šæœ¬å½“å‰æ²¡æœ‰ watchdogï¼Œpppd æ‰çº¿ä¸ä¼šè‡ªåŠ¨é‡æ‹¨
# 2. PPP æ¨¡å¼æ•ˆç‡ä½ï¼ŒQMI/MBIM æ›´ç°ä»£ä¸”ç¨³å®š
# 3. æ—¥å¿— dump / debug ä¼šé¢‘ç¹å†™ Flashï¼Œé‡äº§å»ºè®®å†™å†…å­˜ç›˜
# 4. defaultroute ä¼šè¦†ç›–ç³»ç»Ÿé»˜è®¤è·¯ç”±ï¼Œéœ€è¦ç­–ç•¥è·¯ç”±æ§åˆ¶å¤šç½‘å£ç¯å¢ƒ
# 5. å»ºè®®ç»“åˆ USB/GPIO å¤ä½ï¼Œå®ç°æ¨¡å—æ‰çº¿è‡ªæ„ˆ
# ============================================================


```

## 4G æ‹¨å·è¿‡ç¨‹

```sh

root@rk3568-buildroot:/# sh /etc/ppp/peers/quectel-pppd.sh
quectel-pppd options in effect:
devname   /dev/ttyUSB2    # (default) â†’ ä½ é€‰æ‹©çš„ PPP æ•°æ®å£
apn       3gnet    # (default) â†’ ä½¿ç”¨çš„è¿è¥å•† APN
user      user   # (default) â†’ PPP æ‹¨å·ç”¨æˆ·å
password  passwd   # (default) â†’ PPP æ‹¨å·å¯†ç 

root@rk3568-buildroot:/# pppd options in effect:
debug		# (from command line) â†’ è¾“å‡ºè¯¦ç»†è°ƒè¯•ä¿¡æ¯
nodetach	# (from command line) â†’ ä¸åå°è¿è¡Œï¼Œæ–¹ä¾¿è°ƒè¯•
dump		# (from command line) â†’ è¾“å‡ºæ•°æ®åŒ…å†…å®¹
noauth		# (from command line) â†’ ä¸è¦æ±‚å¯¹ç«¯è®¤è¯
user user	# (from command line) â†’ ç”¨æˆ·å
password ??????	# (from command line) â†’ å¯†ç ï¼ˆéšè—æ˜¾ç¤ºï¼‰
/dev/ttyUSB2	# (from command line) â†’ ç‰©ç†ä¸²å£
115200		# (from command line) â†’ æ³¢ç‰¹ç‡
lock		# (from command line) â†’ é”å®šä¸²å£
connect ''chat -s -v ABORT BUSY ABORT "NO CARRIER" ABORT "NO DIALTONE" ABORT ERROR ABORT "NO ANSWER" TIMEOUT 30 "" AT OK ATE0 OK ATI\;+CSUB\;+CSQ\;+CPIN?\;+COPS?\;+CGREG?\;\&D2 OK AT+CGDCONT=1,\"IP\",\"3gnet\",,0,0 OK ATD*99# CONNECT'' 
                # (from command line) â†’ æ‹¨å·è„šæœ¬ï¼Œç”¨ chat æ‰§è¡Œ AT æŒ‡ä»¤å’Œæ‹¨å·
disconnect chat -s -v ABORT ERROR ABORT "NO DIALTONE" SAY "\nSending break to the modem\n" "" +++ "" +++ "" +++ SAY "\nGood bay\n"
                # (from command line) â†’ æ–­å¼€è¿æ¥æ—¶æ‰§è¡Œçš„ chat æŒ‡ä»¤
nocrtscts	# (from command line) â†’ ç¦ç”¨ RTS/CTS ç¡¬ä»¶æµæ§
modem		# (from command line) â†’ ä½¿ç”¨ modem æ¨¡å¼
novj		# (from command line) â†’ ç¦ç”¨ Van Jacobson å‹ç¼©
novjccomp	# (from command line) â†’ ç¦ç”¨å‹ç¼©
ipcp-accept-local	# (from command line) â†’ æ¥å—å¯¹ç«¯ç»™æœ¬æœºåˆ†é…çš„ IP
ipcp-accept-remote	# (from command line) â†’ æ¥å—å¯¹ç«¯è¦æ±‚åˆ†é…ç»™å¯¹æ–¹çš„ IP
noipdefault	# (from command line) â†’ ä¸ä½¿ç”¨é»˜è®¤ IP
ipcp-max-configure 30	# (from command line) â†’ IPCP æœ€å¤§é…ç½®å°è¯•æ¬¡æ•°
defaultroute	# (from command line) â†’ æ‹¨å·æˆåŠŸåè®¾ç½®é»˜è®¤è·¯ç”±
usepeerdns	# (from command line) â†’ ä½¿ç”¨å¯¹ç«¯æä¾›çš„ DNS
noccp		# (from command line) â†’ ç¦ç”¨å‹ç¼©æ§åˆ¶åè®®
abort on (BUSY)	# é‡åˆ° BUSY ç«‹å³ä¸­æ­¢
abort on (NO CARRIER) # é‡åˆ° NO CARRIER ç«‹å³ä¸­æ­¢
abort on (NO DIALTONE) # é‡åˆ° NO DIALTONE ç«‹å³ä¸­æ­¢
abort on (ERROR) # é‡åˆ° ERROR ç«‹å³ä¸­æ­¢
abort on (NO ANSWER) # é‡åˆ° NO ANSWER ç«‹å³ä¸­æ­¢
timeout set to 30 seconds # æ¯ä¸ª expect çš„è¶…æ—¶æ—¶é—´

send (AT^M)
expect (OK)
^M
OK
 -- got it
                # å‘é€ AT æ£€æŸ¥æ¨¡å—æ˜¯å¦åœ¨çº¿ï¼Œæ”¶åˆ° OK

send (ATE0^M)
expect (OK)
^M
^M
OK
 -- got it
                # ç¦ç”¨å›æ˜¾ ECHOï¼Œæ”¶åˆ° OK

send (ATI;+CSUB;+CSQ;+CPIN?;+COPS?;+CGREG?;&D2^M)
expect (OK)
^M
^M
Quectel^M
EC800M^M
Revision: EC800MCNLFR06A07M04^M
^M
SubEdition: V01^M
^M
+CSQ: 16,99^M
^M
+CGREG: 2,0^M
^M
+CPIN: READY^M
^M
+COPS: 0^M
^M
OK
 -- got it
                # æŸ¥è¯¢æ¨¡å—ä¿¡æ¯ã€ä¿¡å·è´¨é‡ã€æ³¨å†ŒçŠ¶æ€å’Œ SIM çŠ¶æ€ï¼Œæ¨¡å—è¿”å› OKï¼ŒSIM å°±ç»ª

send (AT+CGDCONT=1,"IP","3gnet",,0,0^M)
expect (OK)
^M
^M
OK
 -- got it
                # é…ç½® PDP Contextï¼ŒAPN ä¸º 3gnetï¼Œæ¨¡å—ç¡®è®¤ OK

send (ATD*99#^M)
expect (CONNECT)
^M
^M
CONNECT
 -- got it
                # æ‹¨å·æˆåŠŸï¼Œæ¨¡å—è¿”å› CONNECTï¼Œè¡¨ç¤º PPP é“¾è·¯å¯ä»¥å»ºç«‹

Script ''chat ... ATD*99# CONNECT'' finished (pid 2752), status = 0x0
                # æ‹¨å·è„šæœ¬é¡ºåˆ©å®Œæˆï¼Œstatus=0 è¡¨ç¤ºæ²¡æœ‰é”™è¯¯

Serial connection established.
using channel 1
Using interface ppp0
                # PPP é“¾è·¯å»ºç«‹æˆåŠŸï¼Œä½¿ç”¨ ppp0 æ¥å£

sent [LCP ConfReq id=0x1 <asyncmap 0x0> <magic 0xaa353776> <pcomp> <accomp>]
rcvd [LCP ConfReq id=0x1 <asyncmap 0x0> <auth pap> <magic 0x32d478c8> <pcomp> <accomp>]
sent [LCP ConfAck id=0x1 <asyncmap 0x0> <auth pap> <magic 0x32d478c8> <pcomp> <accomp>]
rcvd [LCP ConfAck id=0x1 <asyncmap 0x0> <magic 0xaa353776> <pcomp> <accomp>]
                # LCP é“¾è·¯åå•†ï¼ŒåŒæ–¹äº¤æ¢ ConfReq/ConfAck åŒ…

sent [PAP AuthReq id=0x1 user="user" password=<hidden>]
rcvd [PAP AuthAck id=0x1 "" 00]
PAP authentication succeeded
                # PPP è®¤è¯ä½¿ç”¨ PAPï¼Œè®¤è¯æˆåŠŸ

sent [IPCP ConfReq id=0x1 <addr 0.0.0.0> <ms-dns1 0.0.0.0> <ms-dns2 0.0.0.0>]
rcvd [LCP TermReq id=0x2]
LCP terminated by peer
                # å¯¹ç«¯æ¨¡å—ç«‹å³å‘é€ LCP ç»ˆæ­¢è¯·æ±‚ï¼ŒæŒ‚æ–­ PPP é“¾è·¯ â†’ æ¨¡å—æ‹’ç» PPP

sent [LCP TermAck id=0x2]
rcvd [IPCP ConfReq id=0x0]
Discarded non-LCP packet when LCP not open
rcvd [IPCP ConfRej id=0x1 <ms-dns1 0.0.0.0> <ms-dns2 0.0.0.0>]
Discarded non-LCP packet when LCP not open
Modem hangup
Connection terminated.
                # PPP é“¾è·¯å½»åº•æ–­å¼€ï¼Œæ— æ³•åˆ†é… IPï¼Œæœ€ç»ˆè¿æ¥å¤±è´¥

```

## PPP æ‹¨å· å¯¹æ¯” QMI æ‹¨å·

| é¡¹ç›®    | PPP    | QMI    |
| ----- | ------ | ------ |
| å¹´ä»£    | æ‹¨å·æ—¶ä»£   | LTE æ—¶ä»£ |
| æ•°æ®é€šé“  | ttyUSB | wwan0  |
| ç¨³å®šæ€§   | âŒ      | âœ…      |
| æ‰çº¿æ¢å¤  | æ‰‹å†™è„šæœ¬   | æ¨¡å—è‡ªåŠ¨   |
| ç»´æŠ¤æˆæœ¬  | é«˜      | ä½      |
| è¿è¥å•†å…¼å®¹ | å·®      | å¥½      |
| æ— äººè½¦é‡äº§ | âŒ ä¸æ¨è  | âœ… å¼ºçƒˆæ¨è |

## QMI æ‹¨å·

```bash

lxg@lxg:~/code/project/linux/rk3568_linux$ ls ./buildroot/board/rockchip/common/base/usr/bin/
4G_dialing.sh  5G_dialing.sh  create_ap  quectel-CM  rkisp_demo  rpdzkj-mobilenet.sh  video_camera.sh

```

**4G_dialing.sh**

```sh

#!/bin/bash

# =========================
# 4G æ¨¡å—è‡ªåŠ¨æ‹¨å·è„šæœ¬ï¼ˆQuectel EC20 / EC200 ç³»åˆ—ï¼‰
# åŠŸèƒ½ï¼š
# 1. éå† USB è®¾å¤‡ï¼Œè¯†åˆ« Quectel 4G æ¨¡å—
# 2. åˆ¤æ–­æ˜¯å¦å·²æœ‰ç½‘ç»œæ¥å£ï¼ˆusb0 / wwan0ï¼‰
# 3. è‹¥æ— æ¥å£æˆ–ç½‘ç»œä¸é€šï¼š
#    - é€šè¿‡ AT æŒ‡ä»¤åˆ‡æ¢ usbnet æ¨¡å¼
#    - å¯åŠ¨ quectel-CM è¿›è¡Œ QMI/ECM æ‹¨å·
# =========================

# /dev/serial/by-id ä¸‹æ˜¯ udev åˆ›å»ºçš„â€œç¨³å®šä¸²å£åâ€
DIRECTORY="/dev/serial/by-id"

# ä¿å­˜æœ€ç»ˆé€‰ä¸­çš„ AT ä¸²å£
Serial_port=""

# è®¡æ•°å™¨ï¼Œç”¨äºé€‰ç¬¬ N ä¸ª ttyUSBï¼ˆQuectel é€šå¸¸ç¬¬ 3 ä¸ªæ˜¯ AT å£ï¼‰
counter=0


# =========================
# å‡½æ•°ï¼šSwitching_mode
# ä½œç”¨ï¼š
#   1. æ ¹æ® USB è®¾å¤‡ä¿¡æ¯æ‹¼å‡º serial-by-id åå­—
#   2. åœ¨ /dev/serial/by-id ä¸­æ‰¾åˆ°å¯¹åº” ttyUSB
#   3. é»˜è®¤å–ç¬¬ 3 ä¸ªï¼ˆcounter == 2ï¼‰
# =========================
Switching_mode()
{
    # USB è®¾å¤‡ä¿¡æ¯ï¼ˆæ¥è‡ª sysfsï¼‰
    PRODUCT_NAME=$(cat "$device_dir/product")
    MANUFACTURER=$(cat "$device_dir/manufacturer")
    SERIAL_NUMBER=$(cat "$device_dir/serial")

    # ç”Ÿæˆ /dev/serial/by-id çš„å‰ç¼€å
    # æœ‰äº›æ¨¡å—æ²¡æœ‰åºåˆ—å·ï¼Œè¦å…¼å®¹
    if [ "$SERIAL_NUMBER" == "" ];then 
        Serial="usb-${MANUFACTURER}_${PRODUCT_NAME}"
    else
        Serial="usb-${MANUFACTURER}_${PRODUCT_NAME}_$SERIAL_NUMBER"
    fi

    # åœ¨ by-id ç›®å½•ä¸­æŸ¥æ‰¾å¯¹åº”çš„ä¸²å£
    # Quectel æ¨¡å—é€šå¸¸ï¼š
    # ttyUSB0/1: modem / diag
    # ttyUSB2:   AT æŒ‡ä»¤å£ï¼ˆç»éªŒå€¼ï¼‰
    for file in $(ls "$DIRECTORY" | grep "$Serial" | sort); do
        if [ "$counter" -eq 2 ]; then
            Serial_port=$file
            echo "Serial_port:$Serial_port"
            break
        fi
        counter=$((counter+1))
    done
}

# =========================
# ä¸»æµç¨‹ï¼šéå†æ‰€æœ‰ USB è®¾å¤‡
# =========================
for device_dir in /sys/bus/usb/devices/*; do
    if [ -e "$device_dir/idProduct" ]; then

        # è¯»å– USB Product ID
        product_id=$(cat "$device_dir/idProduct")

        # ==================================================
        # EC200 ç³»åˆ—ï¼ˆ6001 / 6002 / 6005ï¼‰
        # ==================================================
        if [ "$product_id" = "6002" ] || [ "$product_id" = "6001" ] || [ "$product_id" = "6005" ]; then
            echo "This is a EC200 module!"

            # æŸ¥æ‰¾è¯¥ USB è®¾å¤‡ä¸‹æš´éœ²çš„ç½‘ç»œæ¥å£
            for interface in ${device_dir}/*/net/*; do
                name=$(basename $interface)
                echo "name:$name"
            done 

            # å¦‚æœç³»ç»Ÿä¸­ä¸å­˜åœ¨è¯¥ç½‘ç»œæ¥å£
            if [ ! -e "/sys/class/net/$name" ]; then
                echo "$name not found!!!"

                # æŸ¥æ‰¾ AT ä¸²å£
                Switching_mode "$device_dir"

                if [ -e $DIRECTORY/$Serial_port ]; then
                    # åˆ‡æ¢åˆ° usbnet=1ï¼ˆECM/QMI æ¨¡å¼ï¼‰
                    echo -e "AT+QCFG=\"usbnet\",1" > $DIRECTORY/$Serial_port
                    sleep 1

                    # å¯åŠ¨ quectel-CMï¼ˆåå°ï¼‰
                    /usr/bin/quectel-CM >> /tmp/4G.log 2>&1 &
                else
                    echo "The Serial_port not found!!!"
                fi

            else
                # ç½‘ç»œæ¥å£å­˜åœ¨ï¼Œè¿›è¡Œè¿é€šæ€§æµ‹è¯•
                echo "This is EC200 Connection test"
                ping -c 2 -W 3 -I $name 8.8.8.8

                # ping å¤±è´¥ï¼Œè®¤ä¸º 4G æ‰çº¿
                if [ ! "$?" == "0" ]; then
                    echo "EC200 Connect faile!!!"

                    Switching_mode "$device_dir"
                    if [ -e $DIRECTORY/$Serial_port ]; then
                        # åŸå‚è¿™é‡Œæ³¨é‡Šæ‰äº† usbnet=0
                        # è¡¨ç¤ºï¼šä¸å¼ºåˆ¶åˆ‡å› PPP
                        sleep 1
                        /usr/bin/quectel-CM >> /tmp/4G.log 2>&1 &
                    else
                        echo "The Serial_port not found!!!"
                    fi
                else
                    echo "EC200 Connect success!"
                    exit 1
                fi
            fi
        fi

        # ==================================================
        # EC20 ç³»åˆ—ï¼ˆ0125ï¼‰
        # ==================================================
        if [ "$product_id" = "0125" ]; then
            echo "This is a EC20 module!"

            for interface in ${device_dir}/*/net/*; do
                name=$(basename $interface)
                echo "name:$name"
            done

            if [ ! -e "/sys/class/net/$name" ]; then
                echo "$name not found!!!"

                Switching_mode "$device_dir"
                if [ -e $DIRECTORY/$Serial_port ]; then
                    # EC20 é»˜è®¤ä½¿ç”¨ usbnet=0ï¼ˆQMIï¼‰
                    echo -e "AT+QCFG=\"usbnet\",0" > $DIRECTORY/$Serial_port
                    sleep 1
                    /usr/bin/quectel-CM -d >> /tmp/4G.log 2>&1 &
                else
                    echo "The Serial_port not found!!!"
                fi

            else
                echo "This is EC20 Connection test"
                ping -c 2 -W 3 -I $name 8.8.8.8

                if [ ! "$?" == "0" ]; then
                    echo "EC20 Connect faile!!!"

                    Switching_mode "$device_dir"
                    if [ -e $DIRECTORY/$Serial_port ]; then
                        # åŒæ ·ä¸å¼ºåˆ¶åˆ‡æ¢ usbnet
                        sleep 1
                        /usr/bin/quectel-CM -d >> /tmp/4G.log 2>&1 &
                    else
                        echo "The Serial_port not found!!!"
                    fi
                else 
                    echo "EC20 Connect success!"
                    exit 1
                fi
            fi
        fi
    fi
done

```


**quectel-CM**

quectel-CM æ˜¯ç§»è¿œï¼ˆQuectelï¼‰å®˜æ–¹æä¾›çš„ 4G/5G æ•°æ®æ‹¨å·ä¸é“¾è·¯ä¿æŒç¨‹åºï¼Œä¸»è¦ç”¨äº QMI / MBIM / ECM ç­‰â€œé PPPâ€æ‹¨å·æ–¹å¼

**æŸ¥çœ‹å½“å‰ç½‘å¡**

```bash



root@rk3568-buildroot:/# ifconfig
dummy0    Link encap:Ethernet  HWaddr 9A:28:A9:0B:24:0E  
          inet addr:169.254.46.104  Bcast:169.254.255.255  Mask:255.255.0.0
          inet6 addr: fe80::e9f8:8c65:5e92:19e0/64 Scope:Link
          UP BROADCAST RUNNING NOARP  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:10 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:1432 (1.3 KiB)

eth0      Link encap:Ethernet  HWaddr A6:FC:A7:E6:8A:8F  
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)
          Interrupt:46 

lo        Link encap:Local Loopback  
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

p2p0      Link encap:Ethernet  HWaddr 96:BA:06:E7:0E:34  
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)

usb0      Link encap:Ethernet  HWaddr AE:0C:29:A3:9B:6D  
          inet addr:100.89.144.41  Bcast:100.255.255.255  Mask:255.0.0.0
          inet6 addr: fe80::56c4:6eb9:9036:e032/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:29 errors:0 dropped:0 overruns:0 frame:0
          TX packets:45 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:2842 (2.7 KiB)  TX bytes:3954 (3.8 KiB)

wlan0     Link encap:Ethernet  HWaddr 94:BA:06:E7:0E:34  
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)


root@rk3568-buildroot:/# ip route 
default via 100.89.144.214 dev usb0 proto dhcp src 100.89.144.41 metric 1006 
100.0.0.0/8 dev usb0 proto dhcp scope link src 100.89.144.41 metric 1006 
169.254.0.0/16 dev dummy0 scope link src 169.254.46.104 metric 1002 

```






